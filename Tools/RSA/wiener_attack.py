"""
RSA Wiener's Attack script.

WHEN TO USE:
  Use if e is huge or you suspect e is larger than d
  Correct usage would be when d is 1/3 n^(1/4)

USAGE:
  Replace n, e, and c with your params
  Put this into the sage online shell if python gives issues.
"""

from sage.all import continued_fraction, Integer
def wiener(e, n):
    m = 12345
    c = pow(m, e, n)

    list1 = continued_fraction(Integer(e)/Integer(n))
    conv = list1.convergents()
    for i in conv:
        d = int(i.denominator())
        m1 = pow(c, d, n)
        if m1 == m:
            return d


#PUT YOUR n AND e PARAMS HERE
n = 113907651705304885830111485156729906551561013397932202407243602595997834060204548670611357349458965799129102295900373030674007173513350957304152352010740424398667919148283772461760646082205469763244026136123393301751459264308103056222599135963032632648682968407821876086396251761269777950946915687516504587693
e = 101642117761359685724780195186925933978291469910296095286259759827486051174767871679468882887473645725820069613565677629946685681478565756490941445986055186368987502701099695121478348897673840635249795242514478691827802717134790099347408493055166456763661011321179855683652950315668056778508404764564251286593

d = wiener(e,n)

#Prints the potential e
print(d)

#PUT YOUR c HERE
c = 50390173541113653578482909476744644399013158973993076501348117220519945963498578693002924412647727656626885165405571481041180640988006275813711446502865323021075016556525192567866914669621112369770276886460255897357849871691822633224778809957931487432261447266354104673974733426592893610784928546282684678554

#Should print the decoded ctext
print(power_mod(c,d,n))
